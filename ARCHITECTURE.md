# ğŸ—ï¸ Local-First Architecture Diagram

## System Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        USER DEVICE                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                    BROWSER                            â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚           REACT/NEXT.JS APP                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚   UI Layer   â”‚  â”‚  Components  â”‚           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚              â”‚  â”‚              â”‚           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Pages     â”‚  â”‚  â€¢ Modals    â”‚           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  â€¢ Forms     â”‚  â”‚  â€¢ Widgets   â”‚           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚           â”‚                â”‚                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚   Service Layer     â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚                     â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ transactionSvc   â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ accountService   â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ creditCardSvc    â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ loanService      â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ budgetService    â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚    Business Logic   â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚                     â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ Analytics        â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ EMI Calculation  â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ Amortization     â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚  â€¢ Reports          â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â”‚   Dexie.js (ORM)    â”‚               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                    â”‚                           â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â”‚                       â”‚                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚             IndexedDB (Storage)                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  ğŸ“Š Tables:                                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ users                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ households                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ accounts                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ transactions (primary data)               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ categories                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ creditCards                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ creditCardTransactions                    â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ loans                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ loanPayments                              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ budgets                                   â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ budgetPlanItems                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚    â€¢ appSettings                               â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  ğŸ’¾ ~50MB-1GB storage                          â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  âš¡ <20ms operations                           â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  ğŸŒ Works offline                              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚          BACKUP MODULE (Optional)                    â”‚  â”‚
â”‚  â”‚                                                       â”‚  â”‚
â”‚  â”‚  User clicks "Backup Now"                            â”‚  â”‚
â”‚  â”‚         â”‚                                             â”‚  â”‚
â”‚  â”‚         â–¼                                             â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚  â”‚
â”‚  â”‚  â”‚ Export all data â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚   to JSON       â”‚                                 â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚  â”‚
â”‚  â”‚           â”‚                                           â”‚  â”‚
â”‚  â”‚           â–¼                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚  â”‚
â”‚  â”‚  â”‚ Encrypt with    â”‚  AES-256-GCM                    â”‚  â”‚
â”‚  â”‚  â”‚ user password   â”‚  PBKDF2 (100k iter)             â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                 â”‚  â”‚
â”‚  â”‚           â”‚                                           â”‚  â”‚
â”‚  â”‚           â–¼                                           â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                 â”‚  â”‚
â”‚  â”‚  â”‚ Upload to       â”‚                                 â”‚  â”‚
â”‚  â”‚  â”‚ backend         â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                    â”‚            â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚            â”‚  â”‚
â”‚                                          â”‚ â”‚            â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                                           â”‚ â”‚               â”‚
                              HTTPS (TLS)  â”‚ â”‚               â”‚
                                           â”‚ â”‚               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BACKEND SERVER                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚              BACKUP API (Minimal)                  â”‚   â”‚
â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚  POST /api/backup                                 â”‚   â”‚
â”‚  â”‚    â””â”€> Store encrypted blob                       â”‚   â”‚
â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚  GET /api/backup/latest                           â”‚   â”‚
â”‚  â”‚    â””â”€> Return encrypted blob                      â”‚   â”‚
â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚  GET /api/backup/history                          â”‚   â”‚
â”‚  â”‚    â””â”€> Return metadata only                       â”‚   â”‚
â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚  DELETE /api/backup                               â”‚   â”‚
â”‚  â”‚    â””â”€> Delete user's backups                      â”‚   â”‚
â”‚  â”‚                                                    â”‚   â”‚
â”‚  â”‚  ğŸ”’ No business logic                             â”‚   â”‚
â”‚  â”‚  ğŸ”’ Never sees plain data                         â”‚   â”‚
â”‚  â”‚  ğŸ”’ Only stores encrypted blobs                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                       â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚          PostgreSQL Database                      â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  user_backups table:                             â”‚   â”‚
â”‚  â”‚    â€¢ id                                           â”‚   â”‚
â”‚  â”‚    â€¢ user_id                                      â”‚   â”‚
â”‚  â”‚    â€¢ encrypted_data (TEXT)  â† Encrypted blob     â”‚   â”‚
â”‚  â”‚    â€¢ metadata (JSONB)       â† Size, timestamp    â”‚   â”‚
â”‚  â”‚    â€¢ created_at                                   â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â”‚  users table (for auth only):                    â”‚   â”‚
â”‚  â”‚    â€¢ id                                           â”‚   â”‚
â”‚  â”‚    â€¢ email                                        â”‚   â”‚
â”‚  â”‚    â€¢ password_hash                                â”‚   â”‚
â”‚  â”‚                                                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Data Flow Diagrams

### Daily Operations (No Backend)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ Create Transaction
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  UI Component      â”‚
â”‚  (TransactionModal)â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ transactionService.create()
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Service Layer     â”‚
â”‚  â€¢ Validate        â”‚
â”‚  â€¢ Update balance  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ db.transactions.add()
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dexie.js          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Write
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IndexedDB         â”‚
â”‚  (Browser Storage) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â±ï¸ Total Time: 5-20ms
ğŸŒ Network: Not used
âœ… Result: Instant
```

### Backup Flow (Optional)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ Click "Backup Now"
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BackupManager     â”‚
â”‚  â€¢ Get password    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ exportLocalData()
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Read all tables   â”‚
â”‚  from IndexedDB    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Convert to JSON
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Encryption Module â”‚
â”‚  â€¢ AES-256-GCM     â”‚
â”‚  â€¢ PBKDF2 key      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Encrypted blob
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  HTTP POST         â”‚
â”‚  /api/backup       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Upload
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend API       â”‚
â”‚  (Store blob)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ INSERT
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  PostgreSQL        â”‚
â”‚  user_backups      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â±ï¸ Total Time: 2-5 seconds
ğŸŒ Network: Used
ğŸ”’ Security: Encrypted
```

### Restore Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   User   â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
     â”‚
     â”‚ Click "Restore"
     â”‚ Enter password
     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  BackupManager     â”‚
â”‚  â€¢ Confirm warning â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ HTTP GET /api/backup/latest
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Backend API       â”‚
â”‚  (Return blob)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Encrypted blob
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Encryption Module â”‚
â”‚  â€¢ Decrypt         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Plain JSON
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Clear local DB    â”‚
â”‚  Import data       â”‚
â”‚  (Atomic)          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Write all
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IndexedDB         â”‚
â”‚  (Restored)        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ Refresh page
         â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App reloads       â”‚
â”‚  with restored dataâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â±ï¸ Total Time: 3-8 seconds
ğŸŒ Network: Used
ğŸ”’ Security: Decrypted locally
```

## Component Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              Application Shell                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  LocalFirstProvider                             â”‚
â”‚    â€¢ Check migration status                     â”‚
â”‚    â€¢ Show wizard if needed                      â”‚
â”‚    â€¢ Initialize database                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                       â”‚
        â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App Routes   â”‚      â”‚  Backup UI    â”‚
â”‚               â”‚      â”‚               â”‚
â”‚  /dashboard   â”‚      â”‚  BackupMgr    â”‚
â”‚  /transactionsâ”‚      â”‚  StatusInd    â”‚
â”‚  /accounts    â”‚      â”‚               â”‚
â”‚  /loans       â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  /budgets     â”‚
â”‚  /analytics   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Use services
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Services     â”‚
â”‚               â”‚
â”‚  transaction  â”‚
â”‚  account      â”‚
â”‚  creditCard   â”‚
â”‚  loan         â”‚
â”‚  budget       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ Direct access
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Dexie.js     â”‚
â”‚               â”‚
â”‚  db.trans...  â”‚
â”‚  db.accounts  â”‚
â”‚  db.loans     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  IndexedDB    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Security Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              USER DEVICE (Trusted)              â”‚
â”‚                                                 â”‚
â”‚  Plain Data:                                    â”‚
â”‚    â€¢ Stored in IndexedDB                        â”‚
â”‚    â€¢ Visible to user                            â”‚
â”‚    â€¢ Protected by browser same-origin policy    â”‚
â”‚    â€¢ Encrypted at OS level (device encryption)  â”‚
â”‚                                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚      When Backup Triggered:             â”‚   â”‚
â”‚  â”‚                                         â”‚   â”‚
â”‚  â”‚  1. Export all data                     â”‚   â”‚
â”‚  â”‚  2. Serialize to JSON                   â”‚   â”‚
â”‚  â”‚  3. Generate random salt (16 bytes)     â”‚   â”‚
â”‚  â”‚  4. Generate random IV (12 bytes)       â”‚   â”‚
â”‚  â”‚  5. Derive key: PBKDF2(password, salt)  â”‚   â”‚
â”‚  â”‚  6. Encrypt: AES-256-GCM(data, key, IV) â”‚   â”‚
â”‚  â”‚  7. Combine: salt + IV + ciphertext     â”‚   â”‚
â”‚  â”‚  8. Base64 encode                       â”‚   â”‚
â”‚  â”‚  9. Upload to backend                   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                      â”‚
                      â”‚ HTTPS (TLS 1.3)
                      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          BACKEND SERVER (Zero-Knowledge)        â”‚
â”‚                                                 â”‚
â”‚  Receives:                                      â”‚
â”‚    â€¢ Base64 encrypted blob                      â”‚
â”‚    â€¢ Metadata (timestamp, size, version)        â”‚
â”‚                                                 â”‚
â”‚  Stores:                                        â”‚
â”‚    â€¢ Encrypted blob in database (TEXT column)   â”‚
â”‚    â€¢ NEVER decrypts                             â”‚
â”‚    â€¢ NEVER sees plain data                      â”‚
â”‚    â€¢ NEVER has decryption key                   â”‚
â”‚                                                 â”‚
â”‚  Can serve:                                     â”‚
â”‚    â€¢ Encrypted blob back to user                â”‚
â”‚    â€¢ Metadata only                              â”‚
â”‚                                                 â”‚
â”‚  Cannot:                                        â”‚
â”‚    âŒ Read transactions                         â”‚
â”‚    âŒ See balances                              â”‚
â”‚    âŒ Know spending patterns                    â”‚
â”‚    âŒ Decrypt without password                  â”‚
â”‚                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Comparison: Before vs After

### Before (Client-Server)

```
User Action â†’ API Call â†’ Backend Processing â†’ Database Query
                â†“
          Network Latency (200-500ms)
                â†“
          Server Processing (50-200ms)
                â†“
          Database Query (50-200ms)
                â†“
          Response Serialization (10-50ms)
                â†“
          Network Latency (200-500ms)
                â†“
          Client Parsing (5-20ms)
                â†“
          UI Update

Total: 515-1470ms ğŸŒ
```

### After (Local-First)

```
User Action â†’ Service Call â†’ IndexedDB Query â†’ UI Update

Total: 5-20ms âš¡
```

---

**Result**: **20-70x faster!** ğŸš€
